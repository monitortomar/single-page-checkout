{"ast":null,"code":"import _classCallCheck from\"/home/quadrish/single-page-checkout/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/quadrish/single-page-checkout/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/quadrish/single-page-checkout/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/quadrish/single-page-checkout/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/quadrish/single-page-checkout/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import{connect}from\"react-redux\";import{updateTotalAmt as _updateTotalAmt}from\"../../redux/total/total.action\";import\"./checkoutPromo.styles.css\";var CheckoutPromo=/*#__PURE__*/function(_React$Component){_inherits(CheckoutPromo,_React$Component);var _super=_createSuper(CheckoutPromo);function CheckoutPromo(props){var _this;_classCallCheck(this,CheckoutPromo);_this=_super.call(this,props);_this.getList=function(){fetch(\"/api/promo\").then(function(res){return res.json();}).then(function(list){return _this.setState({promoList:list.data});});};_this.updatePromo=function(){var myHeaders=new Headers();myHeaders.append(\"Content-Type\",\"application/json\");fetch(\"/api/update_promo\",{method:\"POST\",headers:myHeaders,body:JSON.stringify({code:_this.state.code})}).then(function(response){return response.json();});};_this.state={code:\"\",promoList:[],status:\"\",desc:\"\",totalAmt:0};_this.promoCode=_this.promoCode.bind(_assertThisInitialized(_this));_this.checkStatus=_this.checkStatus.bind(_assertThisInitialized(_this));_this.updatePromo=_this.updatePromo.bind(_assertThisInitialized(_this));return _this;}_createClass(CheckoutPromo,[{key:\"componentDidMount\",value:function componentDidMount(){this.getList();}// Retrieves the list of items from the Express app\n},{key:\"promoCode\",value:function promoCode(event){this.setState({code:event.target.value});}},{key:\"checkStatus\",value:function checkStatus(e){var _this2=this;this.state.promoList.map(function(promo){if(promo.code===_this2.state.code){if(promo.status===false){_this2.setState({status:\"apply\",desc:promo.description});var amt=_this2.props.total;if(_this2.state.code===\"RRD4D32\"){amt=amt/10;amt=amt>5000?5000:amt;amt=_this2.props.total-amt+\"\";}else{amt=amt*0.15;amt=amt>10000?10000:amt;amt=_this2.props.total-amt+\"\";}_this2.setState({totalAmt:amt});_this2.updatePromo();}else{_this2.setState({status:\"no\"});}}});}},{key:\"render\",value:function render(){var updateTotalAmt=this.props.updateTotalAmt;if(this.state.totalAmt===0){updateTotalAmt({total:this.props.total});}else{updateTotalAmt({total:this.state.totalAmt});}if(this.state.status===\"\"){return/*#__PURE__*/React.createElement(\"div\",{className:\"checkout-promotion\"},/*#__PURE__*/React.createElement(\"input\",{className:\"checkout-promotion-input\",type:\"text\",placeholder:\"Add Promocode\",onChange:this.promoCode}),/*#__PURE__*/React.createElement(\"button\",{onClick:this.checkStatus,className:\"checkout-promotion-button\",type:\"submit\"},\"Apply\"));}if(this.state.status===\"apply\"){return/*#__PURE__*/React.createElement(\"div\",{className:\"checkout-promotion\"},/*#__PURE__*/React.createElement(\"input\",{className:\"checkout-promotion-input\",type:\"text\",placeholder:\"Add Promocode\",onChange:this.promoCode}),/*#__PURE__*/React.createElement(\"button\",{onClick:this.checkStatus,className:\"checkout-promotion-button-apply\",type:\"submit\"},\"Apply\"),/*#__PURE__*/React.createElement(\"div\",{className:\"promo-desc\"},this.state.desc));}if(this.state.status===\"no\"){return/*#__PURE__*/React.createElement(\"div\",{className:\"checkout-promotion\"},/*#__PURE__*/React.createElement(\"input\",{className:\"checkout-promotion-input\",type:\"text\",placeholder:\"Add Promocode\",onChange:this.promoCode}),/*#__PURE__*/React.createElement(\"button\",{onClick:this.checkStatus,className:\"checkout-promotion-button-no\",type:\"submit\"},\"Apply\"));}}}]);return CheckoutPromo;}(React.Component);// const CheckoutPromo = () => {\n//   return (\n//     <div className=\"checkout-promotion\">\n//       <input\n//         className=\"checkout-promotion-input\"\n//         type=\"text\"\n//         placeholder=\"Add Promocode\"\n//       />\n//       <button className=\"checkout-promotion-button\" type=\"submit\">\n//         Apply\n//       </button>\n//     </div>\n//   );\n// };\nvar mapDispatchToProps=function mapDispatchToProps(dispatch){return{updateTotalAmt:function updateTotalAmt(total){return dispatch(_updateTotalAmt(total));}};};export default connect(null,mapDispatchToProps)(CheckoutPromo);","map":{"version":3,"sources":["/home/quadrish/single-page-checkout/client/src/components/checkoutPromo/checkoutPromo.component.jsx"],"names":["React","connect","updateTotalAmt","CheckoutPromo","props","getList","fetch","then","res","json","list","setState","promoList","data","updatePromo","myHeaders","Headers","append","method","headers","body","JSON","stringify","code","state","response","status","desc","totalAmt","promoCode","bind","checkStatus","event","target","value","e","map","promo","description","amt","total","Component","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { connect } from \"react-redux\";\n\nimport { updateTotalAmt } from \"../../redux/total/total.action\";\nimport \"./checkoutPromo.styles.css\";\n\nclass CheckoutPromo extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      code: \"\",\n      promoList: [],\n      status: \"\",\n      desc: \"\",\n      totalAmt: 0,\n    };\n    this.promoCode = this.promoCode.bind(this);\n    this.checkStatus = this.checkStatus.bind(this);\n    this.updatePromo = this.updatePromo.bind(this);\n  }\n\n  componentDidMount() {\n    this.getList();\n  }\n\n  // Retrieves the list of items from the Express app\n  getList = () => {\n    fetch(\"/api/promo\")\n      .then((res) => res.json())\n      .then((list) => {\n        return this.setState({ promoList: list.data });\n      });\n  };\n\n  updatePromo = () => {\n    var myHeaders = new Headers();\n    myHeaders.append(\"Content-Type\", \"application/json\");\n    fetch(\"/api/update_promo\", {\n      method: \"POST\",\n      headers: myHeaders,\n      body: JSON.stringify({ code: this.state.code }),\n    }).then(function (response) {\n      return response.json();\n    });\n  };\n\n  promoCode(event) {\n    this.setState({ code: event.target.value });\n  }\n\n  checkStatus(e) {\n    this.state.promoList.map((promo) => {\n      if (promo.code === this.state.code) {\n        if (promo.status === false) {\n          this.setState({\n            status: \"apply\",\n            desc: promo.description,\n          });\n          let amt = this.props.total;\n          if (this.state.code === \"RRD4D32\") {\n            amt = amt / 10;\n            amt = amt > 5000 ? 5000 : amt;\n            amt = this.props.total - amt + \"\";\n          } else {\n            amt = amt * 0.15;\n            amt = amt > 10000 ? 10000 : amt;\n            amt = this.props.total - amt + \"\";\n          }\n          this.setState({\n            totalAmt: amt,\n          });\n          this.updatePromo();\n        } else {\n          this.setState({\n            status: \"no\",\n          });\n        }\n      }\n    });\n  }\n\n  render() {\n    const { updateTotalAmt } = this.props;\n    if (this.state.totalAmt === 0) {\n      updateTotalAmt({\n        total: this.props.total,\n      });\n    } else {\n      updateTotalAmt({\n        total: this.state.totalAmt,\n      });\n    }\n    if (this.state.status === \"\") {\n      return (\n        <div className=\"checkout-promotion\">\n          <input\n            className=\"checkout-promotion-input\"\n            type=\"text\"\n            placeholder=\"Add Promocode\"\n            onChange={this.promoCode}\n          />\n          <button\n            onClick={this.checkStatus}\n            className=\"checkout-promotion-button\"\n            type=\"submit\"\n          >\n            Apply\n          </button>\n        </div>\n      );\n    }\n    if (this.state.status === \"apply\") {\n      return (\n        <div className=\"checkout-promotion\">\n          <input\n            className=\"checkout-promotion-input\"\n            type=\"text\"\n            placeholder=\"Add Promocode\"\n            onChange={this.promoCode}\n          />\n          <button\n            onClick={this.checkStatus}\n            className=\"checkout-promotion-button-apply\"\n            type=\"submit\"\n          >\n            Apply\n          </button>\n          <div className=\"promo-desc\">{this.state.desc}</div>\n        </div>\n      );\n    }\n    if (this.state.status === \"no\") {\n      return (\n        <div className=\"checkout-promotion\">\n          <input\n            className=\"checkout-promotion-input\"\n            type=\"text\"\n            placeholder=\"Add Promocode\"\n            onChange={this.promoCode}\n          />\n          <button\n            onClick={this.checkStatus}\n            className=\"checkout-promotion-button-no\"\n            type=\"submit\"\n          >\n            Apply\n          </button>\n        </div>\n      );\n    }\n  }\n}\n\n// const CheckoutPromo = () => {\n//   return (\n//     <div className=\"checkout-promotion\">\n//       <input\n//         className=\"checkout-promotion-input\"\n//         type=\"text\"\n//         placeholder=\"Add Promocode\"\n//       />\n//       <button className=\"checkout-promotion-button\" type=\"submit\">\n//         Apply\n//       </button>\n//     </div>\n//   );\n// };\n\nconst mapDispatchToProps = (dispatch) => ({\n  updateTotalAmt: (total) => dispatch(updateTotalAmt(total)),\n});\n\nexport default connect(null, mapDispatchToProps)(CheckoutPromo);\n"]},"metadata":{},"sourceType":"module"}